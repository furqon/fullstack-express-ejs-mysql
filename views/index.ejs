<%- include('partials/header') %>
<div class="container mt-4">
  <h1>Blog Posts</h1>
  <a href="/add" class="btn btn-primary mb-3">Add New Post</a>
  <a href="/cards" class="btn btn-secondary mb-3">View as Cards</a>
  
  <form action="/" method="get" class="mb-3">
    <div class="input-group">
      <input type="text" name="search" class="form-control" placeholder="Search blogs..." value="<%= search %>">
      <button type="submit" class="btn btn-primary">Search</button>
    </div>
  </form>
  
  <table class="table">
    <thead>
      <tr>
        <th>Title</th>
        <th>Content</th>
        <th>Image</th>
        <th>Created At</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% blogs.forEach(blog => { %>
        <tr>
          <td><%= blog.title %></td>
          <td><%= blog.content.replace(/<[^>]+>/g, '').substring(0, 100) %>...</td>
          <td>
            <% if (blog.image) { %>
              <img src="<%= blog.image %>" alt="Blog Image" style="max-width: 100px;">
            <% } %>
          </td>
          <td><%= blog.created_at %></td>
          <td>
            <a href="/edit/<%= blog.id %>" class="btn btn-sm btn-warning">Edit</a>
            <form action="/delete/<%= blog.id %>" method="post" style="display:inline;">
              <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure?')">Delete</button>
            </form>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>
  
  <nav>
    <ul class="pagination">
      <% for(let i = 1; i <= totalPages; i++) { %>
        <li class="page-item <%= i === page ? 'active' : '' %>">
          <a class="page-link" href="/?page=<%= i %>&search=<%= search %>"><%= i %></a>
        </li>
      <% } %>
    </ul>
  </nav>
</div>
<%- include('partials/footer') %>